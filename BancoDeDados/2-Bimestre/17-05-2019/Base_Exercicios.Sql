ALTER SESSION SET NLS_DATE_FORMAT = 'DDMMYYYY';


CREATE TABLE DEPTO
(
 CD_DEPTO     CHAR(3) NOT NULL
,NM_DEPTO     VARCHAR2(40)
,CD_GERENTE   NUMBER(5)
,CD_DEPTO_CTB CHAR(3)
,PRIMARY KEY (CD_DEPTO)
);

CREATE TABLE FUNC
(
 CD_MAT       NUMBER(5) NOT NULL
,NM_FUNC      VARCHAR2(12)
,NM_SOBRENOME VARCHAR2(12)
,CD_DEPTO     CHAR(3) REFERENCES DEPTO(CD_DEPTO)
,NR_RAMAL     NUMBER(4)
,DT_ADM       DATE
,NR_CARGO     NUMBER(3)
,NR_GIT       NUMBER(2)
,IN_SEXO      VARCHAR2(1) CHECK(IN_SEXO IN ('F', 'M'))
,DT_NASC      DATE
,VL_SAL       NUMBER(9,2)
,NM_FOTO      VARCHAR2(100)
,PRIMARY KEY (CD_MAT)
);


CREATE TABLE PROJ
(
 CD_PROJ	CHAR(6)		NOT NULL,
 NM_PROJ	VARCHAR2(30)	NOT NULL,
 CD_DEPTO	CHAR(3)		NOT NULL
                REFERENCES DEPTO (CD_DEPTO),
 CD_RESP	NUMBER(5)	NOT NULL
                REFERENCES FUNC (CD_MAT),
 QT_EQP		NUMBER(02),
 DT_INI		DATE,
 DT_FIM		DATE,
 PRIMARY KEY (CD_PROJ));

CREATE TABLE ATIV
(
 CD_ATIV          NUMBER(3) PRIMARY KEY,
 NM_SIGLA         VARCHAR2(12),
 TX_DESCRICAO     VARCHAR2(30)
);

CREATE TABLE PRJATV
(CD_PROJ     CHAR(06)   NOT NULL REFERENCES PROJ,
 CD_ATIV     NUMBER(03) NOT NULL REFERENCES ATIV,
 DT_INI      DATE       NOT NULL,
 DT_FIM      DATE       NOT NULL,
 PRIMARY KEY (CD_PROJ, CD_ATIV)
);

CREATE TABLE HST_PROMO
(
 DT_PROMOCAO	DATE      NOT NULL
,CD_MAT         NUMBER(5) NOT NULL
,VL_SAL		NUMBER(9,2)
,CD_DEPTO	CHAR(3)
,NR_CARGO	NUMBER(3)
,TX_MOTIVO      VARCHAR2(200)
,PRIMARY KEY (DT_PROMOCAO, CD_MAT));


INSERT INTO DEPTO VALUES 
  ('A00','DIRETORIA DA EMPRESA',10,NULL);                                   
INSERT INTO DEPTO VALUES 
  ('B01','ASSESSORIA',20,'A00');                                             
INSERT INTO DEPTO VALUES 
  ('C01','CENTRO DE INFORMACAO',30,'A00');                                   
INSERT INTO DEPTO VALUES 
  ('D01','DIRETORIA DE SISTEMAS',NULL,'A00');                                
INSERT INTO DEPTO VALUES 
  ('D11','GERENCIA DE SISTEMAS COMERCIAIS',60,'D01');                                  
INSERT INTO DEPTO VALUES 
  ('D21','GERENCIA DE SISTEMAS ADMINISTRATIVOS',70,'D01');                                  
INSERT INTO DEPTO VALUES 
  ('E01','DIRETORIA DE SUPORTE/PRODUCAO',50,'A00');                                 
INSERT INTO DEPTO VALUES 
  ('E11','OPERACAO',90,'E01');                                               
INSERT INTO DEPTO VALUES 
  ('E21','SUPORTE DE SOFTWARE',100,'E01');


INSERT INTO FUNC VALUES
(10,'CRISTINA','HENDERSON','A00',3978,'01011995',66,18,'F','14081953',5275,'c:\windows\bolhas.bmp');
INSERT INTO FUNC VALUES
(20,'MIGUEL','TEIXEIRA','B01',3476,'10101993',61,18,'M','02021968',4125,'c:\windows\egito.bmp');
INSERT INTO FUNC VALUES
(30,'SANDRA','KWAN','C01',4738,'05041995',60,20,'F','11051961',3825,'c:\windows\ladrilhos.bmp');
INSERT INTO FUNC VALUES
(50,'JOAO','GOMES','E01',6789,'17081989',58,16,'M','15091955',4017.5,'c:\windows\esteira.bmp');
INSERT INTO FUNC VALUES
(60,'IRACY','SOUZA','D11',6423,'14091993',55,16,'F','07071955',3225,'c:\windows\bolhas.bmp');
INSERT INTO FUNC VALUES
(70,'EVA','PEREIRA','D21',7831,'30091990',56,16,'F','26051963',3617,'c:\windows\ladrilhos.bmp');
INSERT INTO FUNC VALUES
(90,'ELIANE','HONOFRE','E11',5498,'15081995',55,16,'F','15051971',2975,'c:\windows\esteira.bmp');
INSERT INTO FUNC VALUES
(100,'TEODORO','SIQUEIRA','E21',972,'16061990',54,14,'M','18121966',2615,'c:\windows\bolhas.bmp');
INSERT INTO FUNC VALUES
(110,'VICENTE','LOURENCO','A00',3490,'16051994',58,19,'M','05111969',4650,'c:\windows\egito.bmp');
INSERT INTO FUNC VALUES
(120,'SILVIO','OLIVA','A00',2167,'05121993',58,14,'M','18101962',2925,'c:\windows\esteira.bmp');
INSERT INTO FUNC VALUES
(130,'DOLORES','QUEIROZ','C01',4578,'28071991',55,16,'F','15091955',2380,'c:\windows\ondas.bmp');
INSERT INTO FUNC VALUES
(140,'HELENA','NOVAES','C01',1793,'15121991',56,18,'F','19011956',2842,'c:\windows\bolhas.bmp');
INSERT INTO FUNC VALUES
(150,'BRUNO','AZEVEDO','D11',4510,'12021992',55,16,'M','17051967',2528,'c:\windows\pied-de-poule.bmp');
INSERT INTO FUNC VALUES
(160,'ELIZABET','PINTO','D11',3782,'11101993',54,17,'F','12041965',2225,'c:\windows\egito.bmp');
INSERT INTO FUNC VALUES
(170,'GABRIEL','YVES','D11',2890,'15091989',54,16,'M','05011971',2468,'c:\windows\bolhas.bmp');
INSERT INTO FUNC VALUES
(180,'MARIA','SANTOS','D11',1682,'07071990',53,17,'F','21021969',2134,'c:\windows\pied-de-poule.bmp');
INSERT INTO FUNC VALUES
(190,'JAIRO','WILARES','D11',2986,'26071994',53,16,'M','25061972',2045,'c:\windows\ladrilhos.bmp');
INSERT INTO FUNC VALUES
(200,'DAVI','BARBOSA','D11',4501,'03031996',55,16,'M','29051971',2774,'c:\windows\ondas.bmp');
INSERT INTO FUNC VALUES
(210,'WILIAM','JONES','D11',942,'11041994',52,17,'M','23021963',1827,'c:\windows\egito.bmp');
INSERT INTO FUNC VALUES
(220,'JOANA','LUZ','D11',672,'29081995',55,18,'F','19031968',2984,'c:\windows\pied-de-poule.bmp');
INSERT INTO FUNC VALUES
(230,'JOAQUIM','JANUARIO','D21',2094,'21111995',53,14,'M','30051965',2218,'c:\windows\bolhas.bmp');
INSERT INTO FUNC VALUES
(240,'SALVADOR','MEDEIROS','D21',3780,'05121993',55,17,'M','31031974',2876,'c:\windows\esteira.bmp');
INSERT INTO FUNC VALUES
(250,'DANIEL','SANTANA','D21',961,'30101999',52,15,'M','12111969',1918,'c:\windows\ladrilhos.bmp');
INSERT INTO FUNC VALUES
(260,'SILVIA','JUVENTO','D21',8953,'11091995',52,16,'F','05101966',1725,'c:\windows\pied-de-poule.bmp');
INSERT INTO FUNC VALUES
(270,'MARTA','PARENTE','D21',9001,'30091990',55,15,'F','26051973',2738,'c:\windows\esteira.bmp');
INSERT INTO FUNC VALUES
(280,'ELINE','SEVERO','E11',8997,'24031991',54,17,'F','28031966',2625,'c:\windows\bolhas.bmp');
INSERT INTO FUNC VALUES
(290,'JOAO','PONTES','E11',4502,'30051990',42,12,'M','09071966',1534,'c:\windows\egito.bmp');
INSERT INTO FUNC VALUES
(300,'FELIPE','SARAIVA','E11',2095,'19061992',48,14,'M','27101956',1775,'c:\windows\esteira.bmp');
INSERT INTO FUNC VALUES
(310,'MARINA','SALGADO','E11',3332,'12091991',43,12,'F','21041971',1590,'c:\windows\ondas.bmp');
INSERT INTO FUNC VALUES
(320,'ROBERTO','MARQUES','E21',9990,'07071990',52,16,'M','11081972',1995,'c:\windows\ladrilhos.bmp');
INSERT INTO FUNC VALUES
(330,'WILSON','LOPES','E21',2103,'23021996',55,14,'M','18071971',2537,'c:\windows\egito.bmp');
INSERT INTO FUNC VALUES
(340,'DILSON','GONCALVES','E21',5698,'05051996',54,16,'M','17051966',2384,'c:\windows\bolhas.bmp');

INSERT INTO PROJ VALUES
('MA2100','AUTOMACAO COMERCIAL', 'D21', 070, 12, '01011996', '01021996');
INSERT INTO PROJ VALUES
('MA2110','PROGRAMACAO', 'D11', 060, 09, '01011996', '01021996');
INSERT INTO PROJ VALUES
('MA2111','ANALISE', 'D11', 150, 02, '01011996', '01021996');
INSERT INTO PROJ VALUES
('MA2112','LEVANTAMENTO', 'D11', 060, 03, '01011996', '01021996');
INSERT INTO PROJ VALUES
('MA2113','DEPURACAO', 'D11', 170, 03, '15021996', '15091996');
INSERT INTO PROJ VALUES
('PL2100','PLANEJAMENTO', 'B01', 020, 01, '01011996', '01021996');
INSERT INTO PROJ VALUES
('IF1000','CONSULTORIA', 'C01', 030, 02, '01011996', '01021996');
INSERT INTO PROJ VALUES
('IF2000','TREINAMENTO', 'C01', 130, 01, '01011996', '01021996');
INSERT INTO PROJ VALUES
('AD3100','SERVICOS ADMINISTRATIVOS', 'A00', 010, 06, '01011996', '01021996');
INSERT INTO PROJ VALUES
('AD3110','ADMINISTRACAO GERAL', 'A00', 110, 06, '01011996', '01021996');
INSERT INTO PROJ VALUES
('AD3111','PROGRAMACAO DE PAGAMENTO', 'D21', 240, 02, '01011996', '01021996');
INSERT INTO PROJ VALUES
('AD3112','PROGRAMACAO DE PESSOAL', 'D21', 250, 01, '01011996', '01021996');
INSERT INTO PROJ VALUES
('AD3113','ASSISTENCIA MEDICA', 'D21', 070, 02, '01011996', '01021996');
INSERT INTO PROJ VALUES
('OP1000','SUPORTE PRODUCAO', 'E01', 050, 06, '01011996', '01021996');
INSERT INTO PROJ VALUES
('OP2010','SUPORTE SISTEMAS', 'E21', 320, 04, '01011996', '01021996');
INSERT INTO PROJ VALUES
('OP2011','SUPORTE SOFTWARE', 'E21', 330, 01, '01011996', '01021996');
INSERT INTO PROJ VALUES
('OP2012','SUPORTE USUARIO', 'E21', 340, 01, '01011996', '01021996');
INSERT INTO PROJ VALUES
('OP2013','SUPORTE DB/DC', 'E21', 100, 01, '01011996', '01021996');
INSERT INTO PROJ VALUES
('OP1010','OPERACAO', 'E11', 090, 05, '01011996', '01021996');
INSERT INTO PROJ VALUES
('OP2000','SISTEMAS DE CONTROLE', 'E01', 050, 05, '01011996', '01021996');



INSERT INTO ATIV VALUES (10, 'GERENCIA', 'GERÊNCIA');
INSERT INTO ATIV VALUES (20, 'CUSTO', 'ESTIMATIVA DE CUSTO');
INSERT INTO ATIV VALUES (30, 'LEVANTAMENTO', 'FASE DE LEVANTAMENTO');
INSERT INTO ATIV VALUES (40, 'DEFINICAO', 'DEFINIÇÃO DE PROGRAMAS');
INSERT INTO ATIV VALUES (50, 'APRESENTACAO', 'APRESENTAÇÃO DO PROJETO');
INSERT INTO ATIV VALUES (60, 'LOGICA', 'DESCRIÇÃO DA LÓGICA');
INSERT INTO ATIV VALUES (70, 'CODIGO', 'CODIFICAÇÃO DE PROGRAMAS');
INSERT INTO ATIV VALUES (80, 'TESTE', 'TESTE DE PROGRAMAS');
INSERT INTO ATIV VALUES (90, 'FISICO', 'PROJETO FÍSICO');
INSERT INTO ATIV VALUES (100, 'CURSO', 'MINISTRAR CURSOS');
INSERT INTO ATIV VALUES (110, 'PREPARACAO', 'DESENVOLVIMENTO DE CURSOS');
INSERT INTO ATIV VALUES (120, 'PESSOAL', 'ADMINISTRAÇÃO DE PESSOAL');
INSERT INTO ATIV VALUES (130, 'OPERACAO', 'OPERAÇÃO DE SISTEMAS');
INSERT INTO ATIV VALUES (140, 'MANUTENCAO', 'MANUTENÇÃO DE SOFTWARE');
INSERT INTO ATIV VALUES (150, 'ADMPROD', 'ADMINISTRAÇÃO DE PRODUÇÃO');
INSERT INTO ATIV VALUES (160, 'ADMDB', 'ADMINISTRAÇÃO BANCO DE DADOS');
INSERT INTO ATIV VALUES (170, 'ADMREDE', 'ADMINISTRAÇÃO DE REDE');
INSERT INTO ATIV VALUES (180, 'DOC', 'DOCUMENTAÇÃO DE SISTEMAS');


INSERT INTO PRJATV VALUES ('AD3110',10, '12041989','22041989');
INSERT INTO PRJATV VALUES ('AD3110',40, '28121991','07011992');
INSERT INTO PRJATV VALUES ('AD3110',70, '13091994','23091994');
INSERT INTO PRJATV VALUES ('AD3111',20, '27061990','28071990');
INSERT INTO PRJATV VALUES ('AD3111',50, '13031993','13041993');
INSERT INTO PRJATV VALUES ('AD3111',80, '28111995','29121995');
INSERT INTO PRJATV VALUES ('AD3112',20, '29061990','01071990');
INSERT INTO PRJATV VALUES ('AD3112',50, '15031993','17031993');
INSERT INTO PRJATV VALUES ('AD3112',80, '30111995','02121995');
INSERT INTO PRJATV VALUES ('AD3113',30, '29031991','21041991');
INSERT INTO PRJATV VALUES ('AD3113',60, '13121993','05011994');
INSERT INTO PRJATV VALUES ('AD3113',90, '29081996','21091996');
INSERT INTO PRJATV VALUES ('IF1000',10, '16031989','23031989');
INSERT INTO PRJATV VALUES ('IF1000',40, '01121991','08121991');
INSERT INTO PRJATV VALUES ('IF1000',70, '17081994','24081994');
INSERT INTO PRJATV VALUES ('IF2000',30, '14121990','01011991');
INSERT INTO PRJATV VALUES ('IF2000',60, '30081993','17091993');
INSERT INTO PRJATV VALUES ('IF2000',90, '16051996','03061996');
INSERT INTO PRJATV VALUES ('MA2100',40, '04111991','05121991');
INSERT INTO PRJATV VALUES ('MA2100',70, '21071994','21081994');
INSERT INTO PRJATV VALUES ('MA2110',10, '19021989','21021989');
INSERT INTO PRJATV VALUES ('MA2110',40, '06111991','08111991');
INSERT INTO PRJATV VALUES ('MA2110',70, '23071994','25071994');
INSERT INTO PRJATV VALUES ('MA2110',100, '08041997','10041997'); 
INSERT INTO PRJATV VALUES ('MA2111',20, '19111989','12121989');
INSERT INTO PRJATV VALUES ('MA2111',50, '05081992','28081992');
INSERT INTO PRJATV VALUES ('MA2111',80, '22041995','15051995');
INSERT INTO PRJATV VALUES ('MA2113',30, '24101990','08111990');
INSERT INTO PRJATV VALUES ('MA2113',60, '10071993','25071993');
INSERT INTO PRJATV VALUES ('MA2113',90, '26031996','10041996');
INSERT INTO PRJATV VALUES ('OP2000',20, '20081990','30081990');
INSERT INTO PRJATV VALUES ('OP2000',50, '06051993','16051993');
INSERT INTO PRJATV VALUES ('OP2000',80, '21011996','31011996');
INSERT INTO PRJATV VALUES ('OP2010',10, '16061989','01071989');
INSERT INTO PRJATV VALUES ('OP2010',40, '02031992','17031992');
INSERT INTO PRJATV VALUES ('OP2010',70, '17111994','02121994');
INSERT INTO PRJATV VALUES ('OP2011',30, '12061991','08071991');
INSERT INTO PRJATV VALUES ('OP2011',60, '26021994','24031994');
INSERT INTO PRJATV VALUES ('OP2011',90, '12111996','08121996');
INSERT INTO PRJATV VALUES ('OP2012',20, '24071990','31071990');
INSERT INTO PRJATV VALUES ('OP2012',50, '09041993','16041993');
INSERT INTO PRJATV VALUES ('OP2012',80, '25121995','01011996');
INSERT INTO PRJATV VALUES ('OP2013',10, '06081989','24081989');
INSERT INTO PRJATV VALUES ('OP2013',40, '22041992','10051992');
INSERT INTO PRJATV VALUES ('OP2013',70, '07011995','25011995');
INSERT INTO PRJATV VALUES ('PL2100',20, '02021990','28021990');
INSERT INTO PRJATV VALUES ('PL2100',50, '19101992','14111992');
INSERT INTO PRJATV VALUES ('PL2100',80, '06071995','01081995');



INSERT INTO HST_PROMO
(DT_PROMOCAO, CD_MAT, VL_SAL, CD_DEPTO, NR_CARGO, TX_MOTIVO)
SELECT DT_ADM, CD_MAT, VL_SAL, CD_DEPTO, NR_CARGO, 'ADMISSÃO'
FROM FUNC;

INSERT INTO HST_PROMO
 (DT_PROMOCAO, CD_MAT, VL_SAL, CD_DEPTO, 
  NR_CARGO, TX_MOTIVO)
 SELECT DT_ADM + 1/1440, CD_MAT, VL_SAL, CD_DEPTO,
        NR_CARGO, 'Cargo gerencial. Não haverá % de valor adicional'
   FROM FUNC
  WHERE CD_MAT IN (SELECT CD_GERENTE FROM DEPTO);

alter table depto
add foreign key (cd_depto_ctb) references depto;
alter table depto
add foreign key (cd_gerente) references func;
commit;